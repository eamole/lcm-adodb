// Generated by CoffeeScript 2.3.1
(function() {
  var ADODB, Db, Field, Table;

  ADODB = require('node-adodb');

  Db = class Db {
    constructor(name1, path, password1, ext = ".mdb") {
      this.name = name1;
      this.path = path;
      this.password = password1;
      this.ext = ext;
      if (typeof password !== "undefined" && password !== null) {
        this.passString = `Jet OLEDB:Database Password=${AERLINGUS}{password}`;
      }
      this.file = this.path + this.ext;
      this.provider = 'Provider=Microsoft.ACE.OLEDB.12.0';
      this.tables = [];
      this.dataSource = `Data Source=${this.file}`;
      this.onnected = false;
    }

    connect() {
      this.cnn = ADODB.open(`${this.provider};${this.dataSource};${this.passString}`);
      return this.onnected = true;
    }

    getTables() {
      if (!this.connected) {
        this.connect();
      }
      return this.cnn.schema(20).then(this.schema(function() {}));
    }

    addTable(name) {
      var table;
      table = new Table(this, name);
      this.tables[name] = table;
      return table;
    }

  };

  Table = class Table {
    constructor(db, name1) {
      this.db = db;
      this.name = name1;
    }

    addField(name, type) {
      var field;
      field = new Field(this, name, type);
      return field;
    }

  };

  Field = class Field {
    constructor(table1, name1, type1, args) {
      this.table = table1;
      this.name = name1;
      this.type = type1;
      this.args = args;
    }

  };

  exports(Db, Table, Field);

}).call(this);

//# sourceMappingURL=db.js.map
